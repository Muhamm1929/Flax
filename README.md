# Class Social Network (Flax)

Мини-соцсеть для класса с отдельной панелью админа.

## Что реализовано

- Регистрация: `name`, `username`, `password` (без кода класса).
- Логин по `username` + `password`.
- При регистрации выдаётся случайный 7-значный ID.
- Профиль показывает: лайки, друзья, сообщения, статус.
- Классный чат: сообщения внутри вашего класса.
- Неоновый Telegram-like UI: анимированные панели, glow-эффекты и более насыщенный home page.
- Лайки: можно лайкать одноклассников и сообщения в чате.
- Статусы:
  - `USER` (обычный)
  - `DEV` (алмазный) — для заранее заданных username в коде
  - `First user` (gold + crown), `Second user` (silver), `Third user` (bronze)
- Классы с 5-значным кодом.
- Пользователь после входа выбирает класс (например 8В/9В/10В), вводит пароль класса и только потом попадает в чат.
- Админ-панель с отдельным входом по 5-значному паролю.
- В админке: управление юзерами, статусами, удалением, созданием/отключением/**удалением** классов и **смена пароля админа**.

## Быстрый старт

```bash
npm install
npm run dev
```

Откройте:

- Соцсеть: `http://localhost:3000/`
- Админка: `http://localhost:3000/admin`

## Как менять пароль админ-панели

Есть два способа:

1. **При первом запуске/деплое** задать стартовый пароль в ENV:

```env
ADMIN_PASSWORD=12345
```

2. **Через UI админки**:
   - зайдите в `/admin`
   - в блоке "Сменить пароль админ-панели" введите текущий и новый пароль (оба 5 цифр)
   - нажмите "Сменить пароль"

После смены пароль сохраняется в `data/store.json` (в хэше), и вход будет только с новым паролем.

## Переменные окружения

```env
PORT=3000
ADMIN_PASSWORD=12345
DEV_USERNAMES=teacher,frienddev
SOCIAL_ORIGIN=https://your-social-domain.vercel.app
ADMIN_ORIGIN=https://your-admin-domain.vercel.app
```

## Разделение доменов на Vercel

1. Разверните этот репозиторий как **два проекта Vercel**:
   - Project A (social domain)
   - Project B (admin domain)
2. В обоих проектах задайте одинаковые ENV.
3. Для CORS проставьте `SOCIAL_ORIGIN` и `ADMIN_ORIGIN`.
4. Назначьте разные кастомные домены на проекты.

## Важно для Vercel

- Исправлено падение `FUNCTION_INVOCATION_FAILED`: хранилище теперь использует `/tmp/flax-store.json` в среде Vercel, чтобы функция не падала из-за read-only файловой системы.
- Учтите, что `/tmp` на serverless не постоянный storage. Для продакшена лучше вынести данные в БД (Supabase/Neon/PlanetScale и т.д.).
